ZnVuY3Rpb24gZ2V0Q2hhdEdwdFN1bW1hcnkoY29udGVudCkgewogIExvZ2dlci5sb2coJ+imgOe4puOBruOCk+WumuWItOWni+WuuScpOwogIAogIGNvbnN0IGFwaUtleSA9IFByb3BlcnRpZXNTZXJ2aWNlLmdldFNjcmlwdFByb3BlcnRpZXMoKS5nZXRQcm9wZXJ0eSgiT1BFTkFJX0FQSV9LRVkiKTsKICBpZiAoIWFwaUtleSkgewogICAgTG9nZ2VyLmxvZygnQVBJ44Kt44O844GM6Kit5a6a44GV44KM44Gm44GE44G+44Gb44KTJyk7CiAgICByZXR1cm4gIkFQSeOCreODvOOCqOODqeODvCI7CiAgfQoKICBjb25zdCBwcm9tcHRUZXh0ID0gYArogZ7ogYzjga/kvJrolabogIDimIHoqJjogIDoqYzjgafjgZnjgILku7vkuIvjga7oqZXkuqt40oCAICoqKiAtICR7Y29udGVudH0KICAtIOWFg+WFg+OBruOBj+OBj+OBj+OBi+OCieW8gOWni+OBl+OBn+aEn+abuOOBp+OBmeOAgiAtKiAqKiogLS0tCmA7CgogIGNvbnN0IHVybCA9ICJodHRwczovL2FwaS5vcGVuYWkuY29tL3YxL2NoYXQvY29tcGxldGlvbnMiOwogIGNvbnN0IHBheWxvYWQgPSB7CiAgICBtb2RlbDogIm8xLW1pbmkiLAogICAgbWVzc2FnZXM6IFsKICAgICAgeyByb2xlOiAidXNlciIsIGNvbnRlbnQ6ICLjgYLjgarjgZ/jga/kvJrolabogIDoqJjogIDoqYzjgafjgZnjgILmrKHjga7lhoXlrrnjgpIyMDDmloflrZjnqY3jgafjimjlrprkuYvjgZnjgovjgZPjgajjgoLjgYLjgorjgb7jgZnjgIIiIH0sCiAgICAgIHsgcm9sZTogInVzZXIiLCBjb250ZW50OiBwcm9tcHRUZXh0IH0KICAgIF0KICB9OwoKICBMb2dnZXIubG9nKCdDaGF0R1BU44Oq44Kv44Ko44K544OI5rGC5aSx5a6aJyk7CgogIGNvbnN0IG9wdGlvbnMgPSB7CiAgICBtZXRob2Q6ICJwb3N0IiwKICAgIGNvbnRlbnRUeXBlOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICBoZWFkZXJzOiB7CiAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHthcGlLZXl9YAogICAgfSwKICAgIHBheWxvYWQ6IEpTT04uc3RyaW5naWZ5KHBheWxvYWQpLAogICAgbXV0ZUh0dHBFeGNlcHRpb25zOiB0cnVlCiAgfTsKCiAgdHJ5IHsKICAgIExvZ2dlci5sb2coJ0NoYXRHUFTjgavjg6rjgq/jgqjjgrnjg4jpgIHkv6EnKTsKICAgIGNvbnN0IHJlc3BvbnNlID0gVXJsRmV0Y2hBcHAuZmV0Y2godXJsLCBvcHRpb25zKTsKICAgIGNvbnN0IGpzb24gPSBKU09OLnBhcnNlKHJlc3BvbnNlLmdldENvbnRlbnRUZXh0KCkpOwogICAgCiAgICBpZiAoanNvbi5lcnJvcikgewogICAgICBMb2dnZXIubG9nKCdDaGF0R1BU44Ko44Op44O844Os44K544Od44Oz44K5OiAnICsgSlNPTi5zdHJpbmdpZnkoanNvbi5lcnJvcikpOwogICAgICByZXR1cm4gIkNoYXRHUFTjgqjjg6njg7wiOwogICAgfQogICAgCiAgICBjb25zdCBhbnN3ZXIgPSBqc29uLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50OwogICAgTG9nZ2VyLmxvZygnQ2hhdEdQVOW/nOWJjeWPl+S/oeaIkOWKnycpOwogICAgcmV0dXJuIGFuc3dlci50cmltKCk7CiAgICAKICB9IGNhdGNoIChlcnJvcikgewogICAgTG9nZ2VyLmxvZygiQ2hhdEdQVCBBUEnpgIHkv6HjgqjjgqTjg7w6ICIgKyBlcnJvcik7CiAgICBMb2dnZXIubG9nKCLjgqjjg6njg7zkvZXntZA6ICIgKyBlcnJvci50b1N0cmluZygpKTsKICAgIHJldHVybiAi6Kit5a6a5Y+W5b6X5aSx5pWXIjsKICB9Cn0=